---
title: AdGuard DNS配置
date: '2024-12-16 23:35:03'
updated: '2024-12-17 00:31:20'
tags:
  - Android
  - Windows
  - AdGuard
  - DNS
permalink: /post/adguard-dns-configuration-zsuejy.html
comments: true
toc: true
---



<span id="20241216233503-m1ufhe1" style="display: none;"></span>因为很早之前就买了 AdGuard，想着进一步配置 AdGuard 的广告拦截，用了 AdGuard 的公共 DNS，使用感受还不错，相应速度也不算慢，就算在国内没有 DNS 服务器，最近的服务器我记得在新加坡和日本来着。既然可以支撑日常的 DNS 请求使用，那么就可以尝试着了解一些了。



AdGuard 的 DNS 可以直接集成进 AdGuard 应用里面，可以不设置系统的 DNS。我手机的设置就是这样设置好的。至于电脑，只要在 AdGuard 里面设置好了 DNS 也能直接给系统应用上，不需要额外设置系统的 DNS。于是就可以设置好两边的 DNS。

## 私人 AdGuard DNS

AdGuard 的 DNS 服务器可以用公用的，也可以私有配置一个。免费额度每个月有 30w 请求，超过请求就不会应用过滤器和用户规则。不过问题不大，我原本还想不用过滤器的，想想还是算了。前段时间阿里 DNS 也限制到每个月 30w 请求，估计是服务器压力太大了，超过了限制会适当降低服务质量，AdGuard 的 DNS 降低服务质量的方式就是超过限制的部分禁用过滤器和用户规则，不过在本地的 AdGuard 上还能继续过滤，实际上的影响不大。

如果你觉得 30w 的请求太少了，那么 AdGuard 还提供了多个进阶的套餐，个人版分别为每月 18 元、每年 145 元，我觉得如果真的有需求的话可以酌情考虑，还算比较便宜。值得注意的是，这个价格有可能是节假日优惠。AdGuard经常提供优惠，可以关注官方动态。

# 配置私人 AdGuard DNS

## 激活服务

打开 [AdGuard DNS](https://adguard-dns.io/ "AdGuard DNS — ad-blocking DNS server") 的官网，使用你的 AdGuard 账号登录，就可以激活免费版服务。在登录的时候会问你的账号类型，可选家庭版和团队版，个人使用选择家庭版就好。

## 设置服务器

在登录进去之后，就会有一个默认的服务器已经创建好。进入设置，可以设置服务器名称、拦截列表、连接设备等。分配给我的默认服务器在新加坡，访问速度还不错。

免费版服务支持最多 2 个服务器，5 个用户，100 条高级设置的访问规则。

​![PixPin_2024-12-16_23-57-25](https://cdn-res.emptylight.cn/share/img/PixPin_2024-12-16_23-57-25-20241216235728-odedhu4.png "AdGuard")​

要看的地方主要是拦截列表、设备。首先根据你的意愿设置若干拦截列表，这个默认有启用一个 AdGuard DNS 过滤器。

### 连接新设备

接着设置好之后就可以着手添加设备。进入设备管理页面，选择连接新设备。

​![PixPin_2024-12-16_23-59-42](https://cdn-res.emptylight.cn/share/img/PixPin_2024-12-16_23-59-42-20241216235943-i4kaf4i.png "连接新设备")​

选择设备类型并输入设备名称，点击下一个进入下一步。之后你就会根据选中的设备类型看到对应的设备连接页面。

​![PixPin_2024-12-17_00-00-43](https://cdn-res.emptylight.cn/share/img/PixPin_2024-12-17_00-00-43-20241217000131-zke9spe.png "添加Windows设备")​

这里以 Windows 为例，点击使用 AdGuard 应用程序，展开后点击 AdGuard 广告拦截程序的连接按钮，就能拉起本地的 AdGuard 广告拦截程序并默认填入 DoH 地址。之后你可以点击手动连接说明查看所有的连接地址，包括 DoH、DoT、DoQ。如果你想的话挨个复制到 AdGuard 广告拦截器的输入框中，每个占一行。不过电脑的访问默认走的是 DoH，这个我不知道怎么回事，我的配置是从 quic 到 tls 再到 DoH 的，应该从上往下应用才对。

​![PixPin_2024-12-17_00-03-24](https://cdn-res.emptylight.cn/share/img/PixPin_2024-12-17_00-03-24-20241217000325-oy1jr7v.png "连接AdGuard应用程序")​

对于安卓应用，在连接界面可以看到多一个二维码，不过我配置的时候二维码不显示，点击连接会拉起电脑的 AdGuard，所以只能手动配置。这里同样点击手动连接说明，找到你的连接链接，按照说明挨个往手机 AdGuard DNS 配置里填，按照 quic 到 tls 到 DoH 的顺序从上往下填，手机就会先用 quic 访问 DNS。

连接好之后点击页面上的我已成功连接到设备按钮或直接返回，都会正常连接上设备。这时候你就可以在仪表盘看到访问了。之后在仪表盘就能看到你每个设备的请求和拦截。还有其他的数据。

## 服务器高级设置

​![PixPin_2024-12-17_00-19-10](https://cdn-res.emptylight.cn/share/img/PixPin_2024-12-17_00-19-10-20241217001912-8diacg7.png)​

接着看服务器设置，有一个对阻止域名的响应，默认是返回零地址。可以设置成 REFUSED 或 NXDOMAIN，比较适配本地 AdGuard 拦截的默认设定。至于 TTL 是请求的超时时间，可以自行设置一个比较折中的值，默认的 10 秒还会频繁请求服务器。根据描述，如果你想要降低对 DNS 服务器的请求，并且认为拦截的请求不需要手动放行并且快速应用更改，那么你就可以设置一个比较高的值。我记得在哪里的 TTL 默认值是 600 秒就是 10 分钟来着，这里我就直接套用了。

下面的四个选项分别有自己的说明，可以按需启用。默认是不记录 IP 地址的，也就是你访问的目标记录下来，但是你的 IP 不被记录。

# 连接完成

在以上配置之后你就已经连接完成了。可以正常使用 AdGuard DNS 了。不过请注意使用速度，两台设备的话免费版的额度估计也只能用一个星期，不知道是不是使用有点太重度了。具体的我还没有测试，不过我是在配置完 2 小时之后边写文章边看着请求数上涨的，已经有 1w 请求了。或许 30w 的请求数确实比较少吧。

## 账号设置

点击账号设置，可以进入 DNS 的账号设置页面。

在刚登录的时候，有选择账号类型，在这里可以再次更改。如果你不想收到使用状况的邮件提醒的话，可以取消“定期收到统计报告”选项。下面的日志及统计数据可以选择是否记录你的访问信息，可以自行设定。还可以在这里购买 AdGuard DNS 的订阅。
